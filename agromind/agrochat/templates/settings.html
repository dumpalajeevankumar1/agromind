{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Settings - AgroChat Dashboard</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
:root {
  --primary-green: #28a745;
  --dark-green: #155724;
  --background-light: #f8f9fa;
  --card-bg: #ffffff;
  --text-color: #333;
  --muted-text: #6c757d;
}
body { font-family: 'Inter', sans-serif; background-color: var(--background-light); margin: 0; padding: 0; color: var(--text-color); }
.dashboard-container { display: flex; min-height: 100vh; }
.sidebar { width: 280px; background-color: var(--card-bg); padding: 2rem; box-shadow: 0 4px 12px rgba(0,0,0,0.05); display: flex; flex-direction: column; justify-content: space-between; position: fixed; height: 100%; left: 0; top: 0; z-index: 1000; transition: transform 0.3s ease; }
.sidebar.collapsed { transform: translateX(-100%); }
.sidebar-header h2 { color: var(--dark-green); font-weight: 600; }
.nav-links .nav-link { display: flex; align-items: center; padding: 0.75rem 1rem; margin-bottom: 0.5rem; color: var(--muted-text); border-radius: 8px; text-decoration: none; transition: 0.3s; }
.nav-links .nav-link:hover, .nav-links .nav-link.active { background-color: var(--primary-green); color: #fff; }
.nav-links .nav-link i { margin-right: 0.75rem; font-size: 1.2rem; }
.main-content { flex-grow: 1; padding: 2rem; margin-left: 280px; display: flex; flex-direction: column; transition: margin-left 0.3s; }
.top-navbar { background-color: #fff; padding: 0.5rem 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; border-radius: 12px; }
.menu-btn { font-size: 1.5rem; cursor: pointer; display: none; }
.top-navbar a { color: var(--text-color); text-decoration: none; margin-left: 1rem; }
.content-card { background-color: var(--card-bg); padding: 2rem; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 2rem; }
.content-card h3 { color: var(--dark-green); margin-bottom: 1rem; }
footer { background-color: var(--card-bg); padding: 1.5rem 2rem; text-align: center; box-shadow: 0 -2px 8px rgba(0,0,0,0.05); width: 100%; margin-top: auto; color: var(--muted-text); border-radius: 12px 12px 0 0; }
@media(max-width:992px) {
  .sidebar { transform: translateX(-100%); }
  .sidebar.collapsed { transform: translateX(0); }
  .main-content { margin-left: 0; }
  .menu-btn { display: block; }
}
</style>
</head>
<body>

<div class="dashboard-container">

  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <div class="sidebar-header"><h2>AgroChat ðŸŒ±</h2></div>
    <div class="nav-links my-4">
      <a href="{% url 'home' %}" class="nav-link"><i class="fas fa-home"></i> Home</a>
      <a href="{% url 'equipment' %}" class="nav-link"><i class="fas fa-tools"></i> Equipment</a>
      <a href="{% url 'chatbot' %}" class="nav-link"><i class="fas fa-robot"></i> Chatbot</a>
      <a href="{% url 'reports' %}" class="nav-link"><i class="fas fa-chart-line"></i> Reports</a>
      <hr>
      <a href="{% url 'profile' %}" class="nav-link"><i class="fas fa-user-circle"></i> Profile</a>
      <a href="{% url 'settings' %}" class="nav-link active"><i class="fas fa-cog"></i> Settings</a>
      <a href="{% url 'logout' %}" class="btn btn-outline-danger w-100 mt-3"><i class="fas fa-sign-out-alt"></i> Logout</a>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <div class="top-navbar">
      <span class="menu-btn" id="menu-btn"><i class="fas fa-bars"></i></span>
      <h4>Settings</h4>
      <div>
        <a href="#"><i class="fas fa-bell"></i></a>
        <a href="#"><i class="fas fa-user-circle"></i></a>
      </div>
    </div>

    <!-- Password Change -->
    <div class="content-card">
      <h3>Change Password</h3>
      <form method="POST" action="{% url 'change_password_request' %}">
        {% csrf_token %}
        <div class="mb-3">
          <label for="current_password" class="form-label">Current Password</label>
          <input type="password" class="form-control" id="current_password" name="current_password" required>
        </div>
        <div class="mb-3">
          <label for="new_password" class="form-label">New Password</label>
          <input type="password" class="form-control" id="new_password" name="new_password" required>
        </div>
        <div class="mb-3">
          <label for="confirm_password" class="form-label">Confirm New Password</label>
          <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
        </div>
        <button type="submit" class="btn btn-success">Request Password Change</button>
      </form>
    </div>

    <!-- Preferences -->
    <div class="content-card">
      <h3>Preferences</h3>
      <form method="POST" action="{% url 'update_preferences' %}">
        {% csrf_token %}
        <div class="mb-3">
          <label for="notifications" class="form-label">Email Notifications</label>
          <select class="form-select" id="notifications" name="notifications">
            <option value="enabled" {% if user.profile.notifications == 'enabled' %}selected{% endif %}>Enabled</option>
            <option value="disabled" {% if user.profile.notifications == 'disabled' %}selected{% endif %}>Disabled</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="language" class="form-label">Language</label>
          <select class="form-select" id="language" name="language">
            <option value="en" {% if user.profile.language == 'en' %}selected{% endif %}>English</option>
            <option value="hi" {% if user.profile.language == 'hi' %}selected{% endif %}>Hindi</option>
            <option value="es" {% if user.profile.language == 'es' %}selected{% endif %}>Spanish</option>
          </select>
        </div>
        <button type="submit" class="btn btn-success">Save Preferences</button>
      </form>
    </div>

    <footer>
      &copy; 2025 AgroChat. All rights reserved.
    </footer>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
const sidebar = document.getElementById('sidebar');
const menuBtn = document.getElementById('menu-btn');
menuBtn.addEventListener('click', () => { sidebar.classList.toggle('collapsed'); });
</script>
</body>
</html>
